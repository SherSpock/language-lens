<!DOCTYPE html>
<html lang="en">

<body>
    <section data-language="spanish">
        <div data-sentence-number="1">
            <p><span data-phrase-id="899ac06e-f8a6-475d-b270-f0b6b37037a6">Se empeña don Miguel de Unamuno </span><span data-phrase-id="f9478691-3576-473c-9a46-8a24fcdb6c3d">en que ponga yo un prólogo a este su libro </span><span data-phrase-id="c1c97863-9f69-4b47-bdf0-d36d99a2338e">en que se relata la tan lamentable historia </span></span><span data-phrase-id="fff0f79f-c83a-436f-a392-eb49f8239c9c">de mi buen amigo Augusto Pérez y su misteriosa muerte, </span><span data-phrase-id="70f24f83-16a1-4f69-863f-d5bf201bb80a">y yo no puedo menos sino escribirlo, </span><span data-phrase-id="989e2de6-9abb-43a9-97bc-cbb6acfd1067">porque los deseos del señor Unamuno son para mí mandatos, </span><span data-phrase-id="26259715-5167-4b68-96f4-28dcb0c1c499">en la más genuina acepción de este vocablo.</span></p>
        </div>
    </section>

    <section data-language="english">
        <div data-sentence-number="1">
            <p><span data-phrase-id="899ac06e-f8a6-475d-b270-f0b6b37037a6">Don Miguel de Unamuno is adamant </span><span data-phrase-id="f9478691-3576-473c-9a46-8a24fcdb6c3d">that I write a prologue for this book of his </span><span data-phrase-id="c1c97863-9f69-4b47-bdf0-d36d99a2338e">in which he tells the lamentable story </span><span data-phrase-id="fff0f79f-c83a-436f-a392-eb49f8239c9c">of my good friend Augusto Pérez and his mysterious death; </span><span data-phrase-id="70f24f83-16a1-4f69-863f-d5bf201bb80a">therefore I have no choice but to write it, </span><span data-phrase-id="989e2de6-9abb-43a9-97bc-cbb6acfd1067">as the wishes of Mr. Unamuno are for me commands, </span><span data-phrase-id="26259715-5167-4b68-96f4-28dcb0c1c499">in the most genuine sense of the word.</span></p>
        </div>
    </section>
</body>

<style>
    .lit {
        color: #7062e9;
    }
</style>

<script>
    const addEventListenersToAllPhrases = () => {        
        for (const phrase of getPhrases()) {
            addEventListenersTo(phrase);
        }
    }

    const getPhrases = () => {
        return document.querySelectorAll('[data-phrase-id]');
    } 

    const addEventListenersTo = (phrase) => {
        phrase.addEventListener('mouseover', handleMouseOverOnPhrase);
        phrase.addEventListener('mouseout', handleMouseOutOnPhrase);
    }

    const handleMouseOverOnPhrase = (mouseOverEvent) => {
        lightSelfAndPair(mouseOverEvent.currentTarget);
    }

    const handleMouseOutOnPhrase = (mouseOutEvent) => {
        dimSelfAndPair(mouseOutEvent.currentTarget);
    }

    const lightSelfAndPair = (phrase) => {
        lightSelf(phrase);
        lightPair(phrase);
    }

    const lightSelf = (phrase) => {
        light(phrase);
    }

    const lightPair = (phrase) => {
        light(getPairOf(phrase));
    }

    const light = (phrase) => {
        phrase.classList.add('lit');
    }

    const dimSelfAndPair = (phrase) => {
        dimSelf(phrase);
        dimPair(phrase);
    }

    const dimSelf = (phrase) => {
        dim(phrase);
    }

    const dimPair = (phrase) => {
        dim(getPairOf(phrase));
    }

    const dim = (phrase) => {
        phrase.classList.remove('lit');
    }

    const getPairOf = (phrase) => {
        const [pair] = document.querySelectorAll(`[data-phrase-id="${phrase.dataset.phraseId}"]:not([data-language="${getLanguageOf(phrase)}"]`);
        return pair;
    }

    const getLanguageOf = (element) => {
        return element.dataset.language;
    }

    const assignLanguagePropertyToAllPhrases = () => {
        for (const phrase of getPhrases()) {
            assignLanguagePropertyTo(phrase);
        }
    }

    const assignLanguagePropertyTo = (phrase) => {
        phrase.setAttribute('data-language', getLanguageOf(phrase.parentElement.parentElement.parentElement));
    }

    addEventListenersToAllPhrases();
    assignLanguagePropertyToAllPhrases();
</script>

</html>